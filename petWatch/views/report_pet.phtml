<?php include 'template/header.phtml'; ?>

    <div class="row">
        <div class="col-md-6 col-md-offset-3">
            <h2 class="text-center"><?php echo $edit_mode ? 'Edit Pet' : 'Report New Missing Pet'; ?></h2>

            <?php if (isset($error_message) && $error_message): ?>
                <div class="alert alert-danger">
                    <?php echo htmlspecialchars($error_message); ?>
                </div>
            <?php endif; ?>

            <?php if (isset($success_message) && $success_message): ?>
                <div class="alert alert-success">
                    <?php echo htmlspecialchars($success_message); ?>
                </div>
            <?php endif; ?>

            <form method="post" action="report_pet.php<?php echo $edit_mode ? '?edit_id=' . $pet_data['id'] : ''; ?>" enctype="multipart/form-data">
                <div class="form-group">
                    <label for="name">Pet Name *</label>
                    <input type="text" class="form-control" id="name" name="name"
                           value="<?php echo $edit_mode ? htmlspecialchars($pet_data['name']) : ''; ?>" required>
                </div>

                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="species">Species *</label>
                            <input type="text" class="form-control" id="species" name="species"
                                   value="<?php echo $edit_mode ? htmlspecialchars($pet_data['species']) : ''; ?>" required>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="breed">Breed *</label>
                            <input type="text" class="form-control" id="breed" name="breed"
                                   value="<?php echo $edit_mode ? htmlspecialchars($pet_data['breed']) : ''; ?>" required>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="color">Color *</label>
                            <input type="text" class="form-control" id="color" name="color"
                                   value="<?php echo $edit_mode ? htmlspecialchars($pet_data['color']) : ''; ?>" required>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="gender">Gender *</label>
                            <select class="form-control" id="gender" name="gender" required>
                                <option value="">Select Gender</option>
                                <option value="Male" <?php echo ($edit_mode && $pet_data['gender'] == 'Male') ? 'selected' : ''; ?>>Male</option>
                                <option value="Female" <?php echo ($edit_mode && $pet_data['gender'] == 'Female') ? 'selected' : ''; ?>>Female</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="age">Age (years)</label>
                            <input type="number" class="form-control" id="age" name="age"
                                   value="<?php echo $edit_mode ? htmlspecialchars($pet_data['age']) : ''; ?>"
                                   min="0" max="100" step="0.1">
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="status">Status *</label>
                            <select class="form-control" id="status" name="status" required>
                                <option value="">Select Status</option>
                                <option value="lost" <?php echo ($edit_mode && $pet_data['status'] == 'lost') ? 'selected' : ''; ?>>Lost</option>
                                <option value="found" <?php echo ($edit_mode && $pet_data['status'] == 'found') ? 'selected' : ''; ?>>Found</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="photo">Pet Photo</label>
                    <input type="file" class="form-control" id="photo" name="photo" accept="image/*">
                    <?php if ($edit_mode && !empty($pet_data['photo_url'])): ?>
                        <p class="help-block">
                            Current photo: <?php echo htmlspecialchars($pet_data['photo_url']); ?>
                        </p>
                    <?php endif; ?>
                </div>

                <div class="form-group">
                    <label for="description">Description *</label>
                    <textarea class="form-control" id="description" name="description" rows="4" required><?php echo $edit_mode ? htmlspecialchars($pet_data['description']) : ''; ?></textarea>
                </div>

                <div class="form-group text-center">
                    <button type="submit" name="action" value="save" class="btn btn-primary btn-lg">
                        <?php echo $edit_mode ? 'Update Pet' : 'Save Pet'; ?>
                    </button>
                    <button type="submit" name="action" value="delete" class="btn btn-default btn-lg">
                        Clear Form
                    </button>
                </div>
            </form>

            <div class="text-center" style="margin-top: 30px;">
                <a href="../index.php" class="btn btn-default">Home</a>
                <a href="help.php" class="btn btn-default">Help</a>
                <a href="manage_pets.php" class="btn btn-default">Manage Pets</a>
            </div>
        </div>
    </div>

<?php include 'template/footer.phtml'; ?>